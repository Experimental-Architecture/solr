<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Apache Solr Search &mdash; apache_solr 7.3.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="apache_solr 7.3.1 documentation" href="index.html" />
    <link rel="next" title="Apache Groovy" href="groovy_main.html" />
    <link rel="prev" title="Welcome to apache_solr’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="groovy_main.html" title="Apache Groovy"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to apache_solr’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">apache_solr 7.3.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="apache-solr-search">
<h1>Apache Solr Search<a class="headerlink" href="#apache-solr-search" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-and-summary">
<h2>Overview and Summary<a class="headerlink" href="#overview-and-summary" title="Permalink to this headline">¶</a></h2>
<p>Documentation can also be referenced in the <a class="reference external" href="https://github.com/gctools-outilsgc/apache-solr-search">Github repository</a></p>
<p>Official Documentatioon for some of the components mentioned in this documentation:</p>
<ul class="simple">
<li><a class="reference external" href="http://lucene.apache.org/solr/guide/7_3">Apache Solr</a></li>
<li><a class="reference external" href="https://docs.docker.com/install/linux/docker-ce/ubuntu/#prerequisites">Docker Community Edition</a></li>
<li><a class="reference external" href="https://kubernetes.io/docs/home/?path=users&amp;persona=app-developer&amp;level=foundational">Kubernetes</a></li>
</ul>
<p>This entire project will contain small components that can be used for testing as minimal viable products. It is not required to have everything running, the main files that this project will use will be in the solr-configuration-files/:</p>
<ul class="simple">
<li>/elgg-core/ contains the solr core configuration files that is required to be placed within /opt/solr/server/solr/ and will need the directory /index/ to be created. The entire directory will need to be accessed by solr, root access can be possible if the instance is created in the development environment.</li>
<li>/groovy-scripts/ contains the script that will retrieve json data from the web application through REST API and push it into the Solr search engine to create index</li>
<li>/jar-files/ contains missing jar files that solr may be missing, there may be some errors that could come up after a fresh install of the engine</li>
</ul>
<p>There are also other configuration files to be considered if the instance will be deployed as either in a Kubernetes pod or as Docker containers, which can be found in the following:</p>
<ul class="simple">
<li>/docker-configuration-files/ contains the Dockerfile that will be required to deploy containers</li>
<li>/kubernetes-configuration-files/ contains the kubernetes configuration files that will be required to deploy in a pod</li>
</ul>
<p>The idea for this project was converting the Solr instance into service which will then be managed in Kubernetes. This service will require access to files and REST API in order to index the content on the site as well as being able to search the contents within various documents (including .pdf, .doc, .docx, etc). The way it works is that the REST API will provide a more accurate content data without scraping an entire web page with all the excess JavaScript and HTML code and pushed to the Solr instance for indexing. This will help with results manipulation when it is displayed on the front end (can be tested using the ReactJS application) as well as retrieving data that would only be available to the user (if access roles are implemented). Please see the groovy scripts, the elgg plugin solr_api for a more in depth technical information, and the diagram below for the workflow.</p>
<img alt="_images/basic_server_architecture.PNG" src="_images/basic_server_architecture.PNG" />
<p>In the diagram above, we have the web application server that is connected to both the database server and FTP file server. The web application server will contain the REST API that will be used to retrieve data from either the database and links to files from the FTP server. The APIs (implemented as an Elgg plugin) require authentication since these information could be set to specific access roles by the content owner.</p>
<p>The Groovy scripts that will retrieve the data from the API, manipulate and clean (removing JavaScript and HTML, organizing the data to conform to the Solr schema configuration, etc) the information before it is push and commited to the Solr instance for indexing. The said scripts will be managed on the dedicated search server, which will be run on a daily basis as a crontab on Linux, or scheduler on Windows.</p>
<p>``
&#64;TODO</p>
<ul class="simple">
<li>Groovy scripts allow parameter to specify Solr and REST API URL or IP Address</li>
<li>Create snippet of commands to start up Kubernetes, Docker, or manual set up</li>
<li>Develop more in depth workflow diagram (data flow)</li>
</ul>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a></p>
</div>
<div class="section" id="dependencies-and-requirements">
<h2>Dependencies and Requirements<a class="headerlink" href="#dependencies-and-requirements" title="Permalink to this headline">¶</a></h2>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut dictum diam fermentum accumsan commodo. Suspendisse ut imperdiet leo. Vivamus quis cursus elit. Vestibulum vestibulum sapien at enim tincidunt tempor. Suspendisse potenti. Vivamus nec ornare diam. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas nec facilisis turpis. Pellentesque nunc nisi, tincidunt eget cursus quis, auctor imperdiet erat. Morbi quis mauris ligula. Suspendisse metus nunc, vulputate in rutrum non, vehicula vitae dolor. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Nulla arcu augue, placerat nec sem nec, aliquet placerat erat. Integer rutrum lectus eget massa fermentum, et lacinia sem tincidunt. Etiam id erat diam. Fusce metus dui, tristique eu justo eu, finibus aliquam nisl.</p>
<p>Since there is a Dockerfile included within this repository, all the dependencies will be automatically included into the project.
The dockerfile includes the following dependencies (the versions may change over time).
This instance of Solr within a Docker and orchestrated by local instance of Kubernetes was developed on Ubuntu Server 16 LTS. This docker repository can be found at <a class="reference external" href="https://hub.docker.com/r/pandurx/solr-service/">https://hub.docker.com/r/pandurx/solr-service/</a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Virtual Machine Specifications</th>
<th class="head">Dependencies</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ul class="first last simple">
<li>Ubuntu Server 16 LTS</li>
<li>4GB RAM</li>
<li>100GB ROM</li>
<li>VMware Workstation 14 Player</li>
</ul>
</td>
<td><table border="1" class="first last docutils">
<colgroup>
<col width="27%" />
<col width="16%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Library</th>
<th class="head">Version</th>
<th class="head">Link</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Apache Solr</td>
<td>7.3.0</td>
<td><a class="reference external" href="http://lucene.apache.org/solr/">http://lucene.apache.org/solr/</a></td>
</tr>
<tr class="row-odd"><td>Apache Groovy</td>
<td>3.0.0</td>
<td><a class="reference external" href="http://groovy-lang.org">http://groovy-lang.org</a></td>
</tr>
<tr class="row-even"><td>Apache Tika</td>
<td>1.17</td>
<td><a class="reference external" href="https://tika.apache.org/">https://tika.apache.org/</a></td>
</tr>
<tr class="row-odd"><td>Apache Maven</td>
<td>3.5.2</td>
<td><a class="reference external" href="https://maven.apache.org/">https://maven.apache.org/</a></td>
</tr>
<tr class="row-even"><td>Open JDK</td>
<td>1.8.0</td>
<td><a class="reference external" href="http://openjdk.java.net/">http://openjdk.java.net/</a></td>
</tr>
<tr class="row-odd"><td>Docker CE</td>
<td>&nbsp;</td>
<td><a class="reference external" href="https://www.docker.com/">https://www.docker.com/</a></td>
</tr>
<tr class="row-even"><td>Kubernetes</td>
<td>&nbsp;</td>
<td><a class="reference external" href="https://kubernetes.io/">https://kubernetes.io/</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td colspan="2">Updated on June 1 2018</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installation-and-implementation">
<h2>Installation and Implementation<a class="headerlink" href="#installation-and-implementation" title="Permalink to this headline">¶</a></h2>
<p>Maecenas vehicula dapibus odio, in faucibus dolor fringilla nec. Mauris vestibulum urna erat, a sodales est viverra at. Sed libero nulla, sodales nec maximus vel, pretium quis tortor. Fusce tellus eros, vehicula ut imperdiet mollis, finibus iaculis enim. Donec id mi mauris. Suspendisse molestie elementum feugiat. Nullam et interdum odio, vestibulum placerat arcu. Fusce laoreet, lacus ut ullamcorper mollis, leo odio gravida ex, pulvinar vestibulum felis tellus ac arcu. Integer nec enim cursus, tristique risus quis, volutpat velit. Aenean pretium elit eros, non hendrerit mauris euismod ac. Ut vitae posuere tellus, nec lobortis ligula. Duis arcu mi, suscipit non dui vel, ullamcorper imperdiet lectus.</p>
<div class="section" id="installing-docker">
<h3>Installing Docker<a class="headerlink" href="#installing-docker" title="Permalink to this headline">¶</a></h3>
<p>Nam ut risus id ipsum blandit semper in sit amet ipsum. Ut tincidunt, justo at sagittis venenatis, turpis enim blandit metus, sit amet tempus lacus ex in turpis. Phasellus vitae aliquet quam, ultrices laoreet sapien. Cras varius ipsum nec enim porttitor sagittis. Quisque varius lacus pellentesque accumsan vestibulum. Integer nisi risus, maximus ut blandit in, finibus non nunc. Ut id eros et erat laoreet ornare malesuada sed risus. Mauris efficitur porttitor tempus. Donec odio neque, bibendum ac tempus non, viverra ac quam. Mauris malesuada luctus ultricies. Donec non lacus sagittis, fermentum libero ut, venenatis sapien. Aliquam semper varius orci. Donec eu odio porttitor, bibendum metus ullamcorper, hendrerit dui. Aenean sed placerat neque, in posuere nisl.</p>
<p>Nullam sed sagittis lorem. Curabitur mattis ut quam sit amet ultricies. Praesent eget tristique ex. Sed dignissim mauris nec nisi feugiat, eu euismod odio semper. Maecenas quis posuere ante. Sed quis egestas lorem. Aliquam non arcu sit amet leo dapibus interdum. Vestibulum id blandit eros, id porttitor erat. Pellentesque vitae ipsum et risus ornare vulputate aliquet vulputate nisi. Quisque sed faucibus magna, a aliquam mauris. Nulla sapien ligula, dapibus sed venenatis laoreet, rhoncus vitae quam. Suspendisse nec quam ultrices, rhoncus lacus nec, cursus lorem. Mauris maximus quam ante, hendrerit porta nulla porta quis. Fusce porta diam ut diam imperdiet imperdiet.</p>
</div>
<div class="section" id="installing-kubernetes-local-virtual-machine-optional">
<h3>Installing Kubernetes (local virtual machine, optional)<a class="headerlink" href="#installing-kubernetes-local-virtual-machine-optional" title="Permalink to this headline">¶</a></h3>
<p>Nam ut risus id ipsum blandit semper in sit amet ipsum. Ut tincidunt, justo at sagittis venenatis, turpis enim blandit metus, sit amet tempus lacus ex in turpis. Phasellus vitae aliquet quam, ultrices laoreet sapien. Cras varius ipsum nec enim porttitor sagittis. Quisque varius lacus pellentesque accumsan vestibulum. Integer nisi risus, maximus ut blandit in, finibus non nunc. Ut id eros et erat laoreet ornare malesuada sed risus. Mauris efficitur porttitor tempus. Donec odio neque, bibendum ac tempus non, viverra ac quam. Mauris malesuada luctus ultricies. Donec non lacus sagittis, fermentum libero ut, venenatis sapien. Aliquam semper varius orci. Donec eu odio porttitor, bibendum metus ullamcorper, hendrerit dui. Aenean sed placerat neque, in posuere nisl.</p>
<p>Nullam sed sagittis lorem. Curabitur mattis ut quam sit amet ultricies. Praesent eget tristique ex. Sed dignissim mauris nec nisi feugiat, eu euismod odio semper. Maecenas quis posuere ante. Sed quis egestas lorem. Aliquam non arcu sit amet leo dapibus interdum. Vestibulum id blandit eros, id porttitor erat. Pellentesque vitae ipsum et risus ornare vulputate aliquet vulputate nisi. Quisque sed faucibus magna, a aliquam mauris. Nulla sapien ligula, dapibus sed venenatis laoreet, rhoncus vitae quam. Suspendisse nec quam ultrices, rhoncus lacus nec, cursus lorem. Mauris maximus quam ante, hendrerit porta nulla porta quis. Fusce porta diam ut diam imperdiet imperdiet.</p>
</div>
</div>
<div class="section" id="commands-explained">
<h2>Commands Explained<a class="headerlink" href="#commands-explained" title="Permalink to this headline">¶</a></h2>
<p>Maecenas vehicula dapibus odio, in faucibus dolor fringilla nec. Mauris vestibulum urna erat, a sodales est viverra at. Sed libero nulla, sodales nec maximus vel, pretium quis tortor. Fusce tellus eros, vehicula ut imperdiet mollis, finibus iaculis enim. Donec id mi mauris. Suspendisse molestie elementum feugiat. Nullam et interdum odio, vestibulum placerat arcu. Fusce laoreet, lacus ut ullamcorper mollis, leo odio gravida ex, pulvinar vestibulum felis tellus ac arcu. Integer nec enim cursus, tristique risus quis, volutpat velit. Aenean pretium elit eros, non hendrerit mauris euismod ac. Ut vitae posuere tellus, nec lobortis ligula. Duis arcu mi, suscipit non dui vel, ullamcorper imperdiet lectus.</p>
<p>If you are currently logged in as root user on the linux machine, you might run into an error stating that you cannot start the solr service as that user. Typically, it is much safer to run the solr server with a different user account that has only access necessary directories and the access rights to run specific services that is required for the search functionality.</p>
<p>If the search engine is currently in development or testing, the service can be started with a root user with an additional parameter passed in. Otherwise, omit the <tt class="docutils literal"><span class="pre">-f</span></tt> flag if the service will be started with a non-root user.</p>
<p><strong>Please take note that the script to run the engine is in the ``/opt/solr/bin`` directory. The example below assumes that the the solr script is in the current directory</strong></p>
<p>running solr as a root user</p>
<p><tt class="docutils literal"><span class="pre">root&#64;ubuntu:~#</span> <span class="pre">./solr</span> <span class="pre">start</span> <span class="pre">-f</span></tt></p>
<p><tt class="docutils literal"><span class="pre">root&#64;ubuntu:~#</span> <span class="pre">./solr</span> <span class="pre">stop</span></tt></p>
<p><tt class="docutils literal"><span class="pre">root&#64;ubuntu:~#</span> <span class="pre">./solr</span> <span class="pre">restart</span> <span class="pre">-f</span></tt></p>
<p>running solr as a non-root user</p>
<p><tt class="docutils literal"><span class="pre">solr&#64;ubuntu:~#</span> <span class="pre">./solr</span> <span class="pre">start</span></tt></p>
</div>
<div class="section" id="inline-markup">
<h2><strong>Inline Markup</strong><a class="headerlink" href="#inline-markup" title="Permalink to this headline">¶</a></h2>
<p>Words can have <em>emphasis in italics</em> or be <strong>bold</strong> and you can define
code samples with back quotes, like when you talk about a command: <tt class="docutils literal"><span class="pre">sudo</span></tt>
gives you super user powers!</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Apache Solr Search</a><ul>
<li><a class="reference internal" href="#overview-and-summary">Overview and Summary</a></li>
<li><a class="reference internal" href="#dependencies-and-requirements">Dependencies and Requirements</a></li>
<li><a class="reference internal" href="#installation-and-implementation">Installation and Implementation</a><ul>
<li><a class="reference internal" href="#installing-docker">Installing Docker</a></li>
<li><a class="reference internal" href="#installing-kubernetes-local-virtual-machine-optional">Installing Kubernetes (local virtual machine, optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#commands-explained">Commands Explained</a></li>
<li><a class="reference internal" href="#inline-markup"><strong>Inline Markup</strong></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to apache_solr&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="groovy_main.html"
                        title="next chapter">Apache Groovy</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/solr_main.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="groovy_main.html" title="Apache Groovy"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to apache_solr’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">apache_solr 7.3.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2018, Christine Yu.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>